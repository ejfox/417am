var GenArt,_,art,clColors,d3,deg2rad,options,seed;d3=require("d3"),seed=Date.now(),_=require("lodash"),clColors=require("nice-color-palettes/100"),deg2rad=Math.PI/180,(art=new(GenArt=require("./GenArt"))(seed,options={count:1,randomizeCount:!1,numTicks:55555,randomizeTicks:!0,bgColor:"white",fillColor:"black",constrainEdges:!0,opacity:.8})).makeParticles=function(){return this.ctx.globalCompositeOperation="multiply",this.opacity=this.chance.floating({min:.5,max:1}),this.colors=this.chance.pickone(clColors),this.colors=this.chance.pickset(this.colors,this.chance.integer({min:2,max:4})),console.log("Making "+this.count+" particles"),this.data=d3.range(this.count).map(function(i){return function(){var e,t,n,a,c;return n=i.chance.integer({min:25,max:i.width}),t={},t.x=i.chance.floating({min:-n,max:n}),t.y=i.chance.floating({min:-n,max:n}),a=i.width/2+t.x,c=i.height/2+t.y,a=_.clamp(a,0,i.width),c=_.clamp(c,0,i.height),e=d3.hsl(i.chance.pickone(i.colors)),e.opacity=i.opacity,{x:i.width/2,y:i.height/2,color:e.toString(),angle:0,angleStep:i.chance.floating({min:-8,max:8}),angleClamp:i.chance.bool(),noise:i.chance.floating({min:.001,max:.8}),hueNoise:i.chance.bool()}}}(this)),this.data},art.tick=function(){var i;return this.ticks||0,this.ticks++,i=this.chance.integer({min:1,max:16}),this.data.forEach(function(e){return function(t,n){var a,c;return c=.25*e.simplex.noise2D(t.x,t.y),e.chance.bool({likelihood:20})&&(t.angleStep+=c*e.chance.floating({min:.001,max:12})),e.chance.bool({likelihood:.25*e.ticks})&&(t.angleStep-=c*e.chance.floating({min:1,max:22})),0===t.x?t.angle=e.chance.integer({min:90,max:360}):t.x===e.width?t.angle=e.chance.integer({min:90,max:360}):0===t.y?t.angle=e.chance.integer({min:0,max:180}):t.y===e.height&&(t.angle=e.chance.integer({min:180,max:360})),t.x=t.x+Math.cos(t.angle*deg2rad),t.y=t.y+Math.sin(t.angle*deg2rad),t.angle+=t.angleStep,t.angleClamp?t.angleStep=_.clamp(t.angleStep,-2,2):t.angleStep=_.clamp(t.angleStep,-i,i),t.angle>360&&(t.angle=0),e.constrainEdges&&(t.x=_.clamp(t.x,0,e.width),t.y=_.clamp(t.y,0,e.height)),e.ctx.beginPath(),1,e.ctx.rect(t.x,t.y,1,1),a=d3.hsl(t.color),a.h+=.12,t.hueNoise&&(a.h+=c*(.01*t.angle)),a.s+=c*t.noise,a.l+=c*t.noise,t.color=a.toString(),e.ctx.fillStyle=t.color,e.ctx.fill(),e.ctx.closePath()}}(this)),this.limitTicks?this.ticks<this.numTicks?requestAnimationFrame(this.tick):this.limitTicks&&this.ticks===this.numTicks?cancelAnimationFrame(this.rafAnimation):void 0:requestAnimationFrame(this.tick)},module.exports=art;