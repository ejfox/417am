var Chance,GenArt,SimplexNoise,_,d3,bind=function(i,t){return function(){return i.apply(t,arguments)}};d3=require("d3"),_=require("lodash"),Chance=require("chance"),SimplexNoise=require("simplex-noise"),GenArt=function(){function i(i,t){this.tick=bind(this.tick,this),this.makeParticles=bind(this.makeParticles,this),this.init=bind(this.init,this),this.seed=i,this.count=1,this.numTicks=50,this.bgColor="white",this.fillColor="black",this.opacity=1,this.elementSelector="",this.ticks=0,t&&(console.log("Options received!",t),Object.assign(this,t))}return i.prototype.makeCanvas=function(){return this.canvas=d3.select(this.elementSelector).node(),this.ctx=this.canvas.getContext("2d"),this.width=this.canvas.width,this.height=this.canvas.height,this.ctx.fillStyle=this.bgColor,this.ctx.fillRect(0,0,this.width,this.height)},i.prototype.init=function(i,t){if(null==i&&(i={}),i&&(console.log("Options received on init!",i),Object.assign(this,i)),this.chance=new Chance(this.seed),this.simplex=new SimplexNoise,this.randomizeCount&&(_.clamp(.25*this.count,1,100),this.count=this.chance.integer({min:.25*this.count,max:this.count})),this.randomizeTicks&&(this.numTicks=this.chance.integer({min:.1*this.numTicks,max:this.numTicks})),this.makeCanvas(),this.makeParticles(),this.tickTil(this.numTicks),i.save&&this.saveFile(),t)return t()},i.prototype.makeParticles=function(){return console.log("Making "+this.count+" particles"),this.data=d3.range(this.count).map(function(i){return function(){var t,e;return t=i.width/2,e=i.height/2,{x:t,y:e,color:i.fillColor}}}(this)),this.data},i.prototype.tick=function(){return this.ctx.fillStyle="rgba(255,255,255,0.01)",this.ctx.fillRect(0,0,this.width,this.height),this.data.forEach(function(i){return function(t,e){return 10,i.chance.bool({likelihood:50})&&(t.x+=i.chance.floating({min:-10,max:10})),i.chance.bool({likelihood:50})&&(t.y+=i.chance.floating({min:-10,max:10})),i.ctx.beginPath(),i.ctx.rect(t.x,t.y,10,10),i.ctx.fillStyle=t.color,i.ctx.fill(),i.ctx.closePath()}}(this)),this.limitTicks?this.ticks<this.numTicks?requestAnimationFrame(this.tick):this.limitTicks&&this.ticks===this.numTicks?cancelAnimationFrame(this.rafAnimation):void 0:requestAnimationFrame(this.tick)},i.prototype.tickTil=function(i){return console.log("Ticking "+this.data.length+" particles "+i+" times"),console.time("Ticked for"),this.rafAnimation=requestAnimationFrame(this.tick),console.timeEnd("Ticked for")},i}(),module.exports=GenArt;